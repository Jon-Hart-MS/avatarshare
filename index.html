<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Digital Avatar QnA</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link href="./css/styles.css" rel="stylesheet">
    <script src="https://aka.ms/csspeech/jsbrowserpackageraw"></script>
    <script src="./js/chat.js"></script>
    <style>
        .configuration-container {
            display: none; /* Hide by default */
        }
    </style>
    <script>
        function toggleConfigVisibility() {
            const configSection = document.getElementById('configuration');
            const checkbox = document.getElementById('showConfigCheckbox');
            if (checkbox.checked) {
                configSection.style.display = 'block';
            } else {
                configSection.style.display = 'none';
            }
        }

        window.onload = function() {
            document.getElementById('configuration').style.display = 'none';
        }
    </script>
</head>
<body>
    <header>
        <h1>Digital Avatar QnA</h1>
    </header>

    <main class="main-container">
        <section id="videoContainer" class="video-container">
            <div id="overlayArea" class="overlay-area">
                <textarea id="chatHistory" class="chat-history" hidden></textarea>
            </div>
            <div id="localVideo" class="local-video" hidden>
                <video src="video/lisa-casual-sitting-idle.mp4" autoplay loop muted></video>
            </div>
            <div id="remoteVideo" class="remote-video"></div>
            <div class="controls">
                <button id="startSession" onclick="window.startSession()">Open Avatar Session</button>
                <button id="microphone" onclick="window.microphone()" disabled>Start Microphone</button>
                <button id="stopSpeaking" onclick="stopSpeaking()" disabled>Stop Speaking</button>
                <button id="clearChatHistory" onclick="window.clearChatHistory()">Clear Chat History</button>
                <button id="stopSession" onclick="window.stopSession()" disabled>Close Avatar Session</button>
            </div>
        </section>

        <section class="text-container">
            <h1>Welcome to Your Interactive Session with a Digital Avatar</h1>
            <p>Experience the cutting-edge of Microsoft AI through your conversation with A Digital Avatar. To get started, simply click the "Start Microphone" button below and ask your questions about Microsoft's AI technologies. This Avatar is here to provide insights on a variety of topics including the latest innovations and responsible AI practices.</p>
            <h2>Sample Questions You Can Ask:</h2>
            <ul>
                <li>"Tell me more about Copilot for Microsoft 365."</li>
                <li>"How can I make sure I use AI responsibly?"</li>
                <li>"Can I run OpenAI models on Azure?"</li>
            </ul>
            <h2>Supported Languages</h2>
            <p>Arabic, Chinese (Simplified), English, French, German, Italian, Japanese, Korean, Portuguese, Spanish, Swahili, Zulu.</p>
            <h2>Technologies used in this demo</h2>
            <p>Azure Custom Avatars, Azure Speech Service, Azure AI Search, Azure OpenAI GPT-4o.</p>
            <h2>Disclaimer</h2>
            <p>This interactive webpage is a demonstration designed for informational and educational purposes only. It is important to note that this avatar is not a direct representation of Mrs. Barnard herself but a simulated persona developed to showcase Microsoft’s AI capabilities. While we strive to provide accurate and up-to-date information, the responses generated by this AI technology may contain inaccuracies and should not be relied upon for personal, medical, legal, or financial decisions. Microsoft and its affiliates are not responsible for any errors or omissions, or for the results obtained from the use of this technology. Please use this demo with the understanding that while the technology aims to provide helpful information, its outputs should be verified independently.</p>
            <input type="checkbox" id="showConfigCheckbox" onclick="toggleConfigVisibility()"> Show Configuration
        </section>
          
    </main>

    
    <section id="configuration" class="configuration-container">
        <h2>Azure Speech Resource</h2>
        <label for="region">Region:</label>
        <select id="region">
            <option value="westeurope">West Europe</option>
            <option value="westus2">West US 2</option>
            <option value="southeastasia">Southeast Asia</option>
        </select>
        <label for="subscriptionKey">Subscription Key:</label>
        <input id="subscriptionKey" type="password" size="32" value="">
        <div>
            <input type="checkbox" id="enablePrivateEndpoint" onchange="window.updatePrivateEndpoint()">Enable Private Endpoint
        </div>
        <div id="showPrivateEndpointCheckBox" hidden>
            <label for="privateEndpoint">Private Endpoint:</label>
            <input id="privateEndpoint" type="text" size="64" placeholder="https://{your custom name}.cognitiveservices.azure.com/">
        </div>

        <h2>Azure OpenAI Resource</h2>
        <label for="azureOpenAIEndpoint">Endpoint:</label>
        <input id="azureOpenAIEndpoint" type="text" size="64" value="">
        <label for="azureOpenAIApiKey">API Key:</label>
        <input id="azureOpenAIApiKey" type="password" size="32" value="">
        <label for="azureOpenAIDeploymentName">Deployment Name:</label>
        <input id="azureOpenAIDeploymentName" type="text" size="32" value="">
        <label for="prompt">System Prompt:</label>
        <textarea id="prompt" style="width: 640px;">Objective: As a digital Avatar you answer questions about Microsoft AI using only the provided documents. Respond in a conversational and natural manner, matching the query language.
            Instructions:
            Tone: Engaging and natural; avoid lists and excessive formality.
            Multilingual: Detect and respond in the query language.
            Scope: Focus on Microsoft AI topics from the provided documents.
            Brevity: Keep responses under 75 words.
            Politeness: Maintain a polite, professional tone.
            No Comparisons: Avoid discussing competitors; focus on Microsofts offerings.
            Currency: When writing out currency, remove the symbol and use the word (e.g., "five dollars").
            If someone just says Hello, do a brief welcome and introduction.
            Example Query and Response:
            Query: "What are some of the benefits of AI?"
            Response: "AI enhances productivity by automating routine tasks, allowing teams to focus on strategic projects. It analyzes data quickly, scales to handle large datasets, improves customer interactions with smart chatbots, and fosters innovation with new solutions. For industry-specific benefits, I can provide detailed documentation."
            Query: "What is your name?"
            Response: "I am an Avatar created by Microsoft. I am here to provide information on Microsofts AI technologies. How can I help you today?"
            Fallback Responses:
            If you cant find an answer, you can use a variation of the following fallback responses: "While I’d love to help with all topics, my knowledge is primarily in Microsoft’s AI Innovation. For other topics, please do check out our website or get in touch with our team."
            Out-of-Scope Query: "While I’d love to help with all topics, my knowledge is primarily in Microsoft’s AI Innovation. For other topics, please do check out our website or get in touch with our team."
            Competitor Comparison Query: "I focus on Microsofts AI technologies. For specific questions about our products, Im happy to help!"</textarea>
        <div>
            <input type="checkbox" id="enableOyd" onchange="window.updataEnableOyd()" checked>Enable On Your Data
        </div>

        <div id="cogSearchConfig">
            <h2>Azure Cognitive Search Resource</h2>
            <label for="azureCogSearchEndpoint">Endpoint:</label>
            <input id="azureCogSearchEndpoint" type="text" size="64" value="">
            <label for="azureCogSearchApiKey">API Key:</label>
            <input id="azureCogSearchApiKey" type="password" size="32" value="">
            <label for="azureCogSearchIndexName">Index Name:</label>
            <input id="azureCogSearchIndexName" type="text" size="32" value="">
        </div>

        <h2>STT / TTS Configuration</h2>
        <label for="sttLocales">STT Locale(s):</label>
        <input id="sttLocales" type="text" size="64" value="en-US,de-DE,es-ES,fr-FR,it-IT,ja-JP,ko-KR,zh-CN,ar-MA,zu-ZA">
        <label for="ttsVoice">TTS Voice:</label>
        <input id="ttsVoice" type="text" size="32" value="en-US-AvaMultilingualNeural">
        <label for="customVoiceEndpointId">Custom Voice Deployment ID (Endpoint ID):</label>
        <input id="customVoiceEndpointId" type="text" size="32">
        <label for="personalVoiceSpeakerProfileID">Personal Voice Speaker Profile ID:</label>
        <input id="personalVoiceSpeakerProfileID" type="text" size="32">
        <div>
            <input type="checkbox" id="continuousConversation">Continuous Conversation
        </div>

        <h2>Avatar Configuration</h2>
        <label for="talkingAvatarCharacter">Avatar Character:</label>
        <input id="talkingAvatarCharacter" type="text" size="16" value="Lisa">
        <label for="talkingAvatarStyle">Avatar Style:</label>
        <input id="talkingAvatarStyle" type="text" size="16" value="casual-sitting">
        <div>
            <input type="checkbox" id="customizedAvatar" unchecked>Custom Avatar
        </div>
        <div>
            <input type="checkbox" id="autoReconnectAvatar" checked>Auto Reconnect
        </div>
        <div>
            <input type="checkbox" id="useLocalVideoForIdle" onchange="window.updateLocalVideoForIdle()">Use Local Video for Idle
        </div>
    </section>

    <img src="image/Microsoft-logo_rgb_c-gray.png" alt="Microsoft Logo" class="logo">
</body>
</html>
